{% form 'product', product %}
	<div class="pdp-container">
		<div class="pdp-image-variants-wrapper">
			<div class="pdp-variants-wrapper">
				{% unless product.has_only_default_variant %}
				<p class="pdp-variants-title">
					Variantes:
				</p>
				<select class="pdp-variants" id="product-select" name="id">
					{% for variant in product.variants %}
						<option value="{{ variant.id }}"
							{% if variant == product.selected_or_first_available_variant %}
								selected="selected"
							{% endif %}>
							{{ variant.title }} - {{ variant.price | money }}
						</option>
					{% endfor %}
				</select>
				{% endunless %}
			</div>
			<div class="pdp-image-wrapper">
				{% if product.has_only_default_variant %}
					{{ product | image_url: width: product.width | image_tag: class: 'pdp-image', loading: 'lazy' }}
				{% else %}
					{{ product | image_url: width: product.width | image_tag: class: 'pdp-image', loading: 'lazy' }}
				{% endif %}
			</div>
		</div>
		<div class="pdp-text-buttons-wrapper">
			<div class="pdp-text-wrapper">
				<h1 class="pdp-title">
					{{ product.title }} 
				</h1>
				<div class="pdp-price">
					<h3>
						{{ product.selected_or_first_available_variant.price | money }} 
					</h3>
				</div>
				<p class="pdp-description">
					{{ product.description }} 
				</p>
			</div>
			<hr />
			<div class="pdp-buttons-wrapper">
				<div class="pdp-numbers">
				 <p class="numbers-text">
					Cantidad:
				 </p>	 
				 <input type="number" name="quantity" min="1" value="1">
				</div>
				<div class="pdp-buy-button">
					<input type="submit" value="Agregar al carrito âœ“">
					{{ form | payment_button }}
				</div>
			</div>
		</div>
	</div>
{% endform %}
{{ 'option_selection.js' | shopify_asset_url | script_tag }}

<script>
	/* const form = document.querySelector('form')
	
	form.addEventListener('submit', (e) => {
      e.preventDefault()
			const formData = { 
				"items": [
	  			{
	   				"id": '{{ product.variant.id }}',
	   				"quantity": 1
	  			}	
				]
			}
			fetch(`/cart/add.js`, {
				method: 'POST', 
				body: formData}).then((response) => 
					response.json()).then((response) => {
					console.log(response)
			}
			)
		}
	)*/
	var selectCallback = function(variant, selector) {
		console.log(variant, selector)
		return variant, selector;
	};

	new Shopify.OptionSelectors('product-select', {
  	product: {{ product | json }},
  	onVariantSelected: selectCallback,
  	enableHistoryState: true
	});
</script>


{% schema %}
{
	"name": "main-product",
	"settings": [],
	"blocks": [
	{
		"name": "Product",
		"type": "product",
		"settings": [
			{
				"type": "product",
				"id": "product",
				"label": "Product"
			}
		]
	}
]
}  
{% endschema %}